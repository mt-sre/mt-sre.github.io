<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.111.3"><link rel=canonical type=text/html href=/docs/creating-addons/monitoring/><link rel=alternate type=application/rss+xml href=/docs/creating-addons/monitoring/index.xml><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon.png sizes=180x180><link rel=icon type=image/png href=/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=/favicons/android-chrome-512x512.png sizes=512x512><title>Monitoring Addons | Layered Products SRE</title><meta name=description content="How to monitor addons.
"><meta property="og:title" content="Monitoring Addons"><meta property="og:description" content="How to monitor addons.
"><meta property="og:type" content="website"><meta property="og:url" content="/docs/creating-addons/monitoring/"><meta property="og:site_name" content="Layered Products SRE"><meta itemprop=name content="Monitoring Addons"><meta itemprop=description content="How to monitor addons.
"><meta name=twitter:card content="summary"><meta name=twitter:title content="Monitoring Addons"><meta name=twitter:description content="How to monitor addons.
"><link rel=preload href=/scss/main.min.0799d219d5950ac36000bb078e915525f0e42b82cd2a4e21fbeb9a6015fc5ef0.css as=style><link href=/scss/main.min.0799d219d5950ac36000bb078e915525f0e42b82cd2a4e21fbeb9a6015fc5ef0.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo></span><span class=font-weight-bold>Layered Products SRE</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/internal-documentation/access/><span>Getting Access</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.523fbed911f7cff9fcbf267c72e78ed5.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/creating-addons/monitoring/>Return to the regular view of this page</a>.</p></div><h1 class=title>Monitoring Addons</h1><div class=lead>How to monitor addons.</div><ul><li>1: <a href=#pg-85e97a2a253c15db608b0997dc5e62c7>Dead Man's Snitch Operator Integration</a></li><li>2: <a href=#pg-08ad524dc84aaff13a28adb213c5d2d0>SLO Dashboards</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-85e97a2a253c15db608b0997dc5e62c7>1 - Dead Man's Snitch Operator Integration</h1><h2 id=overview>Overview</h2><p><a href=https://deadmanssnitch.com/>Dead Man&rsquo;s Snitch (DMS)</a> is essentially a constantly firing
prometheus alert and an external receiver(called a snitch) that will alert should the
monitoring stack go down and stop sending alerts. The generation of &ldquo;snitch&rdquo; urls is
dynamic on cluster/add-on installed. It&rsquo;s done via the
<a href=https://github.com/openshift/deadmanssnitch-operator>DMS operator</a>,
which runs on hive and is owned by SREP.</p><h2 id=usage>Usage</h2><p>The Add-On metadata file (<code>addon.yaml</code>) allows you to provide
a <code>deadmanssnitch</code> field (see <code>deadmansnitch</code> field in
the Add-On metadata file
<a href=https://github.com/mt-sre/managed-tenants-cli/blob/main/docs/tenants/zz_metadata_schema_generated.md>schema documentation</a>
for more information).
This field allows you to provide the required Dead Man&rsquo;s Snitch integration configuration.
A <code>DeadmansSnitchIntegration</code>resource is then created and applied to Hive alongside the Add-On
<a href=https://github.com/openshift/hive/blob/master/docs/syncset.md#selectorsyncset-object-definition>SelectorSyncSet (SSS)</a>.</p><h3 id=deadmanssnitchintegration-resource>DeadmansSnitchIntegration Resource</h3><p>The default DMS configurations which will be created if you specify the bare minimum
fields under &lsquo;deadmanssnitch&rsquo; field in addon metadata:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>deadmanssnitch.managed.openshift.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DeadmansSnitchIntegration</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-{{ADDON.metadata[&#39;id&#39;]}}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>deadmanssnitch-operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterDeploymentSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>## can be overridden by .deadmanssnitch.clusterDeploymentSelector field in addon metadata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>matchExpressions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{{<span style=color:#000>ADDON.metadata[&#39;label&#39;]}}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>In</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>values</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>dmsAPIKeySecretRef</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>## fixed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>deadmanssnitch-api-key</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>deadmanssnitch-operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>snitchNamePostFix</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{{<span style=color:#000>ADDON.metadata[&#39;id&#39;]}}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>## can be overridden by .deadmanssnitch.snitchNamePostFix field in addon metadata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>tags</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{{<span style=color:#000>ADDON.metadata[&#39;deadmanssnitch&#39;][&#39;tags&#39;]}}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>## Required</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>targetSecretRef</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#8f5902;font-style:italic>## can be overridden by .deadmanssnitch.targetSecretRef.name field in addon metadata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{{<span style=color:#000>ADDON.metadata[&#39;id&#39;]}}-deadmanssnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#8f5902;font-style:italic>## can be overridden by .deadmanssnitch.targetSecretRef.namespace field in addon metadata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{{<span style=color:#000>ADDON.metadata[&#39;targetNamespace&#39;]}}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=examples-of-deadmanssnitch-field-in-addonyaml>Examples of <code>deadmanssnitch</code> field in <code>addon.yaml</code></h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>id</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ocs-converged</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>deadmanssnitch</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>tags</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;ocs-converged-stage&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>id</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>deadmanssnitch</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>snitchNamePostFix</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rhods</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>tags</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;rhods-integration&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>targetSecretRef</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-rhods-deadmanssnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-ods-monitoring</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>id</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>managed-api-service-internal</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>deadmanssnitch</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterDeploymentSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>matchExpressions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;api.openshift.com/addon-managed-api-service-internal&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>In</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>values</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;api.openshift.com/addon-managed-api-service-internal-delete&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NotIn</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>values</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#4e9a06>&#39;true&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>snitchNamePostFix</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rhoam</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>tags</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;rhoam-production&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>targetSecretRef</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-rhoami-deadmanssnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-rhoami-operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=generated-secret>Generated Secret</h3><p>A secrete will be generated (by default in the same namespace as your addon) with the <code>SNITCH_URL</code>.
Your add-on will need to pick up the generated secret in cluster and inject it into your
alertmanager config. Example of in-cluster created secret:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Secret</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-myaddon-operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>hive.openshift.io/managed</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;true&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>SNITCH_URL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>#url like https://nosnch.in/123123123</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Opaque</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=alert>Alert</h3><p>Your alertmanager will need a constantly firing alert that is routed to DMS:
Example of an alert that always fires:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DeadManSnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>interval</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>1m</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>alert</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DeadManSnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>expr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>vector(1)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>severity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>critical</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>This is a DeadManSnitch to ensure RHODS monitoring and alerting pipeline is online.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>summary</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Alerting DeadManSnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=route>Route</h2><p>Example of a route that forwards the firing-alert to DMS:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>match</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>alertname</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DeadManSnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>receiver</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>deadman-snitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>repeat_interval</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>5m</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=receiver>Receiver</h2><p>Example receiver for DMS:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;deadman-snitch&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>webhook_configs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>url</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;&lt;snitch_url&gt;?m=just+checking+in&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>send_resolved</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><div class="alert alert-primary" role=alert>Before going live with the SRES SRE team, they will need to manually point the <code>tags: ["my-addon-production"]</code>
in the Service Delivery DMS account to their pagerduty service.</div><p>Please log a JIRA with your assigned SRE team to have this completed at least one week
before going live with the SRE team.</p><h3 id=current-example>Current Example</h3><ul><li><a href=https://gitlab.cee.redhat.com/service/managed-tenants/-/blob/09cf5112e7dc5588c14f158d6490f7f1e7051c6a/addons/managed-api-service-internal/metadata/production/deadmanssnitch.yaml.j2>RHOAM addon: DMS CR template</a></li><li><a href=https://gitlab.cee.redhat.com/service/managed-tenants/-/blob/09cf5112e7dc5588c14f158d6490f7f1e7051c6a/addons/managed-api-service-internal/metadata/production/addon.yaml#L40>RHOAM addon: extraResources</a>
field in <code>addon.yaml</code></li><li><a href=https://github.com/red-hat-data-services/odh-deployer/blob/cb48c55725fd32fdc89a5ff29517b3f4cc0d1f54/monitoring/prometheus/prometheus.yaml>RHODS addon: alertmanager configuration</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-08ad524dc84aaff13a28adb213c5d2d0>2 - SLO Dashboards</h1><p>Development teams are required to co-maintain, in conjunction with
the MT-SRE Team, SLO Dashboards for the Addons they develop. This
document explains how to bootstrap the dashboard creation and
deployment.</p><h2 id=first-dashboard>First Dashboard</h2><ul><li>Fork/clone the <a href=https://gitlab.cee.redhat.com/service/managed-tenants-slos>managed-tenants-slos repository</a>.</li><li>Create the following directory structure:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>├── &lt;addon-name&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>│   ├── dashboards</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>│   │   └── &lt;addon-name&gt;-slo-dashboard.configmap.yaml</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>│   └── OWNERS</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Example <code>OWNERS</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>approvers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#000>akonarde</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#000>asegundo</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p><code>&lt;addon-name>-slo-dashboard.configmap.yaml</code> contents (replace all occurrences of <code>&lt;addon-name></code>):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>&lt;addon-name&gt;-slo-dashboard</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>grafana_dashboard</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>grafana-folder</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/grafana-dashboard-definitions/Addons</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>mtsre-rhods-slos.json</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>    {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;annotations&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        &#34;list&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;builtIn&#34;: 1,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;datasource&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;type&#34;: &#34;grafana&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;uid&#34;: &#34;-- Grafana --&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;enable&#34;: true,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;hide&#34;: true,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;iconColor&#34;: &#34;rgba(0, 211, 255, 1)&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;name&#34;: &#34;Annotations &amp; Alerts&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;target&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;limit&#34;: 100,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;matchAny&#34;: false,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;tags&#34;: [],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;type&#34;: &#34;dashboard&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;type&#34;: &#34;dashboard&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        ]
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;editable&#34;: true,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;fiscalYearStartMonth&#34;: 0,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;graphTooltip&#34;: 0,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;links&#34;: [],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;liveNow&#34;: false,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;panels&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;datasource&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;type&#34;: &#34;prometheus&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;uid&#34;: &#34;4rNsqZfnz&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;fieldConfig&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;defaults&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;color&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;mode&#34;: &#34;thresholds&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;custom&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;align&#34;: &#34;auto&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;displayMode&#34;: &#34;auto&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;inspect&#34;: false
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;mappings&#34;: [],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;thresholds&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;mode&#34;: &#34;absolute&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;steps&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;color&#34;: &#34;green&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;value&#34;: null
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;color&#34;: &#34;red&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;value&#34;: 80
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                ]
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;overrides&#34;: []
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;gridPos&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;h&#34;: 16,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;w&#34;: 3,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;x&#34;: 0,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;y&#34;: 0
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;id&#34;: 2,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;options&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;footer&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;fields&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;reducer&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;sum&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              ],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;show&#34;: false
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;showHeader&#34;: true
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;pluginVersion&#34;: &#34;9.0.1&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;targets&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;datasource&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;type&#34;: &#34;prometheus&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;uid&#34;: &#34;4rNsqZfnz&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;editorMode&#34;: &#34;code&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;expr&#34;: &#34;group by (_id) (subscription_sync_total{name=\&#34;${addon_name}\&#34;})&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;format&#34;: &#34;table&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;range&#34;: true,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;refId&#34;: &#34;A&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          ],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;title&#34;: &#34;Clusters&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;transformations&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;id&#34;: &#34;groupBy&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;options&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;fields&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  &#34;_id&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;aggregations&#34;: [],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;operation&#34;: &#34;groupby&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          ],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;type&#34;: &#34;table&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      ],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;schemaVersion&#34;: 36,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;style&#34;: &#34;dark&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;tags&#34;: [],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;templating&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        &#34;list&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;hide&#34;: 2,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;name&#34;: &#34;addon_name&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;query&#34;: &#34;addon-&lt;addon-name&gt;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;skipUrlSync&#34;: false,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;type&#34;: &#34;constant&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        ]
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;time&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        &#34;from&#34;: &#34;now-6h&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        &#34;to&#34;: &#34;now&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;timepicker&#34;: {},
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;timezone&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;title&#34;: &#34;&lt;addon-name&gt; - SLO Dashboard&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;version&#34;: 0,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;weekStart&#34;: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>    }</span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span></code></pre></div><ul><li>Create a Merge Request adding the files to the managed-tenants-slos git repository.</li><li>Ping @mt-sre-ic in the #forum-managed-tenants Slack channel for review.</li></ul><h2 id=dashboard-deployment>Dashboard Deployment</h2><p>Merging of the above merge request is a prerequisite for this step.</p><p>The dashboard deployment happens through app-interface, using saas-files.</p><ul><li>For each new Addon, we need to create a new saas-file in app-interface.</li><li>Give ownership of the saas-file to your team using an app-interface role file.</li></ul><p>Example Merge Request content to app-interface:</p><p><a href=https://gitlab.cee.redhat.com/service/app-interface/-/commit/9306800aabaca18cd034dfb3933a12d29506fa08>https://gitlab.cee.redhat.com/service/app-interface/-/commit/9306800aabaca18cd034dfb3933a12d29506fa08</a></p><ul><li>Ping <code>@mt-sre-ic</code> in the <code>#forum-managed-tenants</code> Slack channel for approval.</li><li>Merge Requests to app-interface are constantly reviewed/merged by AppSRE.
After the MT-SRE approval, wait until the Merge Request is merged.</li></ul><h2 id=accessing-the-dashboards>Accessing the Dashboards</h2><p>Once the app-interface merge request is merged, you will see your ConfigMaps
being deployed in the <code>#sd-mt-sre-info</code> Slack channel. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>app-sre-stage-01<span style=color:#ce5c00;font-weight:700>]</span> ConfigMap odf-ms-cluster-status applied
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>app-sre-prod-01<span style=color:#ce5c00;font-weight:700>]</span> ConfigMap odf-ms-cluster-status applied
</span></span></code></pre></div><p>Once the dashboards are deployed, you can see them here:</p><ul><li>STAGE: <a href=https://grafana.stage.devshift.net/dashboards/f/aGqy3WB7k/addons>https://grafana.stage.devshift.net/dashboards/f/aGqy3WB7k/addons</a></li><li>PRODUCTION: <a href=https://grafana.app-sre.devshift.net/dashboards/f/sDiLLtgVz/addons>https://grafana.app-sre.devshift.net/dashboards/f/sDiLLtgVz/addons</a></li></ul><h2 id=development-flow>Development Flow</h2><p>After all the configuration is in place:</p><p>STAGE:</p><ul><li>Dashboards on the STAGE Grafana instance should not be used by
external audiences other than the people developing the dashboards.</li><li>Changes in the <code>managed-tenants-slos</code> repository can be merged by the
development team with &ldquo;/lgtm&rdquo; comments from those in the OWNERS file.</li><li>After merged, changes are automatically delivered to the STAGE grafana instance.</li></ul><p>PRODUCTION:</p><ul><li>The dashboards on the PRODUCTION Grafana are pinpointed to a specific git
commit from the managed-tenants-slos repository in the corresponding
saas-file in app-interface.</li><li>After patching the git commit in the saas-file, owners of the saas-file can merge the promotion
with a &ldquo;/lgtm&rdquo; comment in the app-interface Merge Request.</li></ul></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.3bff53fa2e8d9a2c4d0b3eeea5987ff2f2cc9a0f4eccb730274827d5e7cd5538.js integrity="sha256-O/9T+i6NmixNCz7upZh/8vLMmg9OzLcwJ0gn1efNVTg=" crossorigin=anonymous></script></body></html>