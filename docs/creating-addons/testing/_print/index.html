<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.115.3"><link rel=canonical type=text/html href=/docs/creating-addons/testing/><link rel=alternate type=application/rss+xml href=/docs/creating-addons/testing/index.xml><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon.png sizes=180x180><link rel=icon type=image/png href=/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=/favicons/android-chrome-512x512.png sizes=512x512><title>Testing Addons | Layered Products SRE</title><meta name=description content="How to test addons.
"><meta property="og:title" content="Testing Addons"><meta property="og:description" content="How to test addons.
"><meta property="og:type" content="website"><meta property="og:url" content="/docs/creating-addons/testing/"><meta itemprop=name content="Testing Addons"><meta itemprop=description content="How to test addons.
"><meta name=twitter:card content="summary"><meta name=twitter:title content="Testing Addons"><meta name=twitter:description content="How to test addons.
"><link rel=preload href=/scss/main.min.0799d219d5950ac36000bb078e915525f0e42b82cd2a4e21fbeb9a6015fc5ef0.css as=style><link href=/scss/main.min.0799d219d5950ac36000bb078e915525f0e42b82cd2a4e21fbeb9a6015fc5ef0.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo></span><span class=font-weight-bold>Layered Products SRE</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/internal-documentation/access/><span>Getting Access</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.c6ef0e8b82694527c274ff1c08ddb0f7.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/creating-addons/testing/>Return to the regular view of this page</a>.</p></div><h1 class=title>Testing Addons</h1><div class=lead>How to test addons.</div><ul><li>1: <a href=#pg-a741c5f669408c09f9eba6bafb09347d>Installing a specific version of an Addon in a staging environment</a></li><li>2: <a href=#pg-98595350eaad83b8d6f40022a940b660>Testing With OCP (Without OCM)</a></li><li>3: <a href=#pg-d032643a49d241811ce016a5864099bb>Testing With OSD-E2E</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-a741c5f669408c09f9eba6bafb09347d>1 - Installing a specific version of an Addon in a staging environment</h1><p>Add-on services are typically installed using the OpenShift Cluster Manager
web console, by selecting the specific addon from the <strong>Add-ons</strong> tab and
clicking <strong>Install</strong>.
However, only the latest version of an addon service can be installed using
the OpenShift Cluster Manager console.</p><p>In some cases, you might need to install an older version of an addon, for
example, to test the upgrade of an addon from one version to the next.
Follow this procedure to install a specific version of an addon service in a
staging environment.</p><p><strong>IMPORTANT:</strong>
Installing an addon service using this procedure is only recommended for testing
upgrades in a staging environment and is not supported for customer-facing
production workloads.</p><h2 id=prerequisites>Prerequisites</h2><ul><li><p>You have the <code>version_select</code> capability added to your organization by
creating a merge request to the <a href=https://gitlab.cee.redhat.com/service/ocm-resources><em>ocm-resources respository</em></a>.</p><p>For more information about assigning capabilities to an organization,
see <a href=https://source.redhat.com/groups/public/openshiftplatformsre/blog/customer_capabilities_management><em>Customer Capabilities Management</em></a>.
For more information about enabling the <code>version_select</code> capability,
see <a href=https://gitlab.cee.redhat.com/service/ocm-resources/-/commit/35198592011391d4c296ff75d70a93a454104467><em>organization YAML example</em></a>
and <a href=https://gitlab.cee.redhat.com/service/ocm-resources/-/merge_requests/3271><em>merge request example</em></a>.</p></li></ul><h2 id=procedure>Procedure</h2><ol><li><p>Create a JSON file with the addon service and addon version that you want
to install. In this example, the JSON file is <code>install-payload.json</code>, the
addon id is <code>reference-addon</code>, and the version we want to install is <code>0.6.7</code>.</p><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&#34;addon&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reference-addon&#34;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&#34;addon_version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;0.6.7&#34;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>NOTE:</strong> If the addon that you are installing has a required parameter, ensure
that you add it to the JSON file. For instance, the <code>managed-odh</code> addon,
which is shown in the example below, requires the parameter <code>notification-email</code>
to be included.</p><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;addon&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;managed-odh&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;addon_version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;1.23.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;parameters&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;items&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;notification-email&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>&#34;value&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;me@somewhere.com&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div></li><li><p>Set the <code>CLUSTER_ID</code> environment variable:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>CLUSTER_ID</span><span style=color:#ce5c00;font-weight:700>=</span>&lt;your_cluster_internal_id&gt;
</span></span></code></pre></div></li><li><p>Run the following API request to install the addon:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm post /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addons --body install-payload.json
</span></span></code></pre></div></li><li><p>Verify the addon installation:</p><ol><li><p>Log into your cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>oc login
</span></span></code></pre></div></li><li><p>Run the <code>oc get addons</code> command to view the addon installation status:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ oc get addons
</span></span><span style=display:flex><span>NAME              STATUS   AGE
</span></span><span style=display:flex><span>reference-addon   Pending  10m
</span></span></code></pre></div></li><li><p>Optionally, run the <code>watch</code> command to watch the addon installation status:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ watch oc get addons
</span></span><span style=display:flex><span>NAME                 STATUS    AGE
</span></span><span style=display:flex><span>reference-addon      Ready     32m
</span></span></code></pre></div></li></ol></li><li><p>If you do not want the addon to automatically upgrade to the
latest version after installation, delete the addon upgrade policy before the
addon installation completes.</p><ol><li><p>List the upgrade policies:</p><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ocm get /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;kind&#34;</span>: <span style=color:#4e9a06>&#34;AddonUpgradePolicyList&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;page&#34;</span>: 1,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;size&#34;</span>: 1,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;total&#34;</span>: 1,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;items&#34;</span>: <span style=color:#ce5c00;font-weight:700>[</span>
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;kind&#34;</span>: <span style=color:#4e9a06>&#34;AddonUpgradePolicy&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;id&#34;</span>: <span style=color:#4e9a06>&#34;991a69a5-ce33-11ed-9dda-0a580a8308f5&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;href&#34;</span>: <span style=color:#4e9a06>&#34;/api/clusters_mgmt/v1/clusters/22ogsfo8kd36bk280b6bqbi7l03micmm/addon_upgrade_policies/991a69a5-ce33-11ed-9dda-0a580a8308f5&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;schedule&#34;</span>: <span style=color:#4e9a06>&#34;0,15,30,45 * * * *&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;schedule_type&#34;</span>: <span style=color:#4e9a06>&#34;automatic&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;upgrade_type&#34;</span>: <span style=color:#4e9a06>&#34;ADDON&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;version&#34;</span>: <span style=color:#4e9a06>&#34;&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;next_run&#34;</span>: <span style=color:#4e9a06>&#34;2023-03-29T19:30:00Z&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;cluster_id&#34;</span>: <span style=color:#4e9a06>&#34;22ogsfo8kd36bk280b6bqbi7l03micmm&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;addon_id&#34;</span>: <span style=color:#4e9a06>&#34;reference-addon&#34;</span>
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div></li><li><p>Delete the addon upgrade policy:</p><p><strong>Syntax</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm delete /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies/&lt;addon_upgrade_policy_id&gt;
</span></span></code></pre></div><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm delete /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies/991a69a5-ce33-11ed-9dda-0a580a8308f5
</span></span></code></pre></div></li><li><p>Verify the upgrade policy no longer exists:</p><p><strong>Syntax</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm get /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies <span style=color:#000;font-weight:700>|</span> grep &lt;addon_upgrade_policy_id&gt;
</span></span></code></pre></div><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm get /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies <span style=color:#000;font-weight:700>|</span> grep 991a69a5-ce33-11ed-9dda-0a580a8308f5
</span></span></code></pre></div></li></ol></li><li><p>Review the addon installation status and version:</p><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>$ oc get addons reference-addon -o yaml</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addons.managed.openshift.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Addon</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-03-20T19:07:08Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>finalizers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span>- <span style=color:#000>addons.managed.openshift.io/cache</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>displayName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Reference Addon</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>pause</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0.6.7</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-03-20T19:08:10Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>FullyReconciled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-03-20T19:08:10Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Addon has been successfully installed.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AddonInstalled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Installed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>lastObservedAvailableCSV</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-reference-addon/reference-addon.v0.6.7</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>observedVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0.6.7</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>phase</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Ready</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In this example, you can see the addon version is set to <code>0.6.7</code>
and <code>AddonInstalled</code> status is <code>True</code>.</p></li><li><p>(Optional) If needed, recreate the addon upgrade policy manually.</p><ol><li><p>Create a JSON file with the addon upgrade policy information.</p><p><strong>Example of automatic upgrade</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;kind&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;AddonUpgradePolicy&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;addon_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reference-addon&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;cluster_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;$CLUSTER_ID&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;schedule_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;automatic&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;upgrade_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;ADDON&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>Example of manual upgrade</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;kind&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;AddonUpgradePolicy&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;addon_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reference-addon&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;cluster_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;$CLUSTER_ID&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;schedule_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;manual&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;upgrade_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;ADDON&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;0.7.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>In the example above, the schedule_type for the <code>reference-addon</code> is
set to <code>manual</code> and the version to upgrade to is set <code>0.7.0</code>. The upgrade
policy will execute once and the addon will upgrade to version <code>0.7.0</code>.</p></li><li><p>Run the following API request to install the addon upgrade policy:</p><p><strong>Syntax</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm post /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies --body &lt;your_json_filename&gt;
</span></span></code></pre></div><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm post /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies --body reference-upgrade-policy.json
</span></span></code></pre></div></li><li><p>Verify the upgrade policy exists:</p><p><strong>Syntax</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> ocm get /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.items[] | select(.addon_id==&#34;&lt;addon_id&gt;&#34;)&#39;</span>
</span></span></code></pre></div><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm get /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.items[] | select(.addon_id==&#34;reference-addon&#34;)&#39;</span>
</span></span></code></pre></div></li></ol></li></ol><h2 id=useful-commands>Useful commands</h2><ul><li><p>Get a list of available addons:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm get /api/clusters_mgmt/v1/addons <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.items[].id&#39;</span>
</span></span></code></pre></div></li><li><p>Get a list of available versions to install for a given addon id:</p><p><strong>Syntax</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm get /api/clusters_mgmt/v1/addons/&lt;addon-id&gt;/versions <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.items[].id&#39;</span>
</span></span></code></pre></div><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ocm get /api/clusters_mgmt/v1/addons/reference-addon/versions <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.items[].id&#39;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.0.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.1.5&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.1.6&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.2.2&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.3.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.3.1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.3.2&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.4.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.4.1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.5.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.5.1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.2&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.3&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.4&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.5&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.6&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.7&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.7.0&#34;</span>
</span></span></code></pre></div></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-98595350eaad83b8d6f40022a940b660>2 - Testing With OCP (Without OCM)</h1><h2 id=testing-without-ocm>Testing Without OCM</h2><p>During the development process, it might be useful (and cheaper) to run your
addon on an OCP cluster.</p><p>You can spin up an OCP cluster on your local machine using
<a href=https://cloud.redhat.com/openshift/install/crc/installer-provisioned>CRC</a>.</p><p>OCP and OSD differ in one important aspect: OCP gives you full access, while
OSD restricts the administrative actions. But Managed Tenants will apply
resources as unrestricted admin to OSD, just like you can do with your OCP,
so OCP is a good OSD mockup for our use case.</p><p>By doing this, you&rsquo;re skipping:</p><ul><li>OCM and SKU management</li><li>Hive</li></ul><p>First, you have to build your catalog. Let take the <code>managed-odh</code> as example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ managedtenants --environment<span style=color:#ce5c00;font-weight:700>=</span>stage --addons-dir addons --dry-run run --debug tasks/deploy/10_build_push_catalog.py:managed-odh
</span></span><span style=display:flex><span>Loading stage...
</span></span><span style=display:flex><span>Loading stage <span style=color:#000>OK</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>TASKS</span> <span style=color:#ce5c00;font-weight:700>=======================================================================</span>
</span></span><span style=display:flex><span>tasks/deploy/10_build_push_catalog.py:BuildCatalog:managed-odh:stage...
</span></span><span style=display:flex><span> -&gt; creating the temporary directory
</span></span><span style=display:flex><span> -&gt; /tmp/managed-odh-stage-1bkjtsea
</span></span><span style=display:flex><span> -&gt; generating the bundle directory
</span></span><span style=display:flex><span> -&gt; generating the bundle package.yaml
</span></span><span style=display:flex><span> -&gt; building the docker image
</span></span><span style=display:flex><span> -&gt; <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#39;docker&#39;</span>, <span style=color:#4e9a06>&#39;build&#39;</span>, <span style=color:#4e9a06>&#39;-f&#39;</span>, PosixPath<span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#39;/home/apahim/git/managed-tenants/Dockerfile.catalog&#39;</span><span style=color:#ce5c00;font-weight:700>)</span>, <span style=color:#4e9a06>&#39;-t&#39;</span>, <span style=color:#4e9a06>&#39;quay.io/osd-addons/opendatahub-operator:stage-91918fe&#39;</span>, PosixPath<span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#39;/tmp/managed-odh-stage-1bkjtsea&#39;</span><span style=color:#ce5c00;font-weight:700>)]</span>
</span></span><span style=display:flex><span>tasks/deploy/10_build_push_catalog.py:BuildCatalog:managed-odh:stage OK
</span></span><span style=display:flex><span>tasks/deploy/10_build_push_catalog.py:PushCatalog:managed-odh:stage...
</span></span><span style=display:flex><span> -&gt; pushing the docker image
</span></span><span style=display:flex><span> -&gt; <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#39;docker&#39;</span>, <span style=color:#4e9a06>&#39;--config&#39;</span>, <span style=color:#4e9a06>&#39;/home/apahim/.docker&#39;</span>, <span style=color:#4e9a06>&#39;push&#39;</span>, <span style=color:#4e9a06>&#39;quay.io/osd-addons/opendatahub-operator:stage-91918fe&#39;</span><span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>tasks/deploy/10_build_push_catalog.py:PushCatalog:managed-odh:stage OK
</span></span></code></pre></div><p>That command has built the image
<code>quay.io/osd-addons/opendatahub-operator:stage-91918fe</code> on your local machine.</p><p>You can inspect the image with:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker run --rm -it --entrypoint <span style=color:#4e9a06>&#34;bash&#34;</span>  quay.io/osd-addons/opendatahub-operator:stage-91918fe -c <span style=color:#4e9a06>&#34;ls manifests/&#34;</span>
</span></span><span style=display:flex><span>0.8.0  1.0.0-experiment  managed-odh.package.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ docker run --rm -it --entrypoint <span style=color:#4e9a06>&#34;bash&#34;</span>  quay.io/osd-addons/opendatahub-operator:stage-91918fe -c <span style=color:#4e9a06>&#34;cat manifests/managed-odh.package.yml&#34;</span>
</span></span><span style=display:flex><span>channels:
</span></span><span style=display:flex><span>- currentCSV: opendatahub-operator.1.0.0-experiment
</span></span><span style=display:flex><span>  name: beta
</span></span><span style=display:flex><span>defaultChannel: beta
</span></span><span style=display:flex><span>packageName: managed-odh
</span></span></code></pre></div><p>Next, you have to tag/push that image to some public registry repository of
yours:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker tag quay.io/osd-addons/opendatahub-operator:stage-91918fe quay.io/&lt;my-repository&gt;/opendatahub-operator:stage-91918fe
</span></span><span style=display:flex><span>$ docker push quay.io/&lt;my-repository&gt;/opendatahub-operator:stage-91918fe
</span></span><span style=display:flex><span>Getting image <span style=color:#204a87>source</span> signatures
</span></span><span style=display:flex><span>Copying blob 9fbc4a1ed0b0 <span style=color:#204a87;font-weight:700>done</span>
</span></span><span style=display:flex><span>Copying blob c4d8f7894b7d skipped: already exists
</span></span><span style=display:flex><span>Copying blob 61598d8d1b24 skipped: already exists
</span></span><span style=display:flex><span>Copying blob 38ada4bcd26f skipped: already exists
</span></span><span style=display:flex><span>Copying blob d5fdf1f627c8 skipped: already exists
</span></span><span style=display:flex><span>Copying blob 2bf094d88b12 skipped: already exists
</span></span><span style=display:flex><span>Copying blob 8a6c7bacb5db <span style=color:#204a87;font-weight:700>done</span>
</span></span><span style=display:flex><span>Copying config 3088e48540 <span style=color:#204a87;font-weight:700>done</span>
</span></span><span style=display:flex><span>Writing manifest to image destination
</span></span><span style=display:flex><span>Copying config 3088e48540 <span style=color:#ce5c00;font-weight:700>[</span>--------------------------------------<span style=color:#ce5c00;font-weight:700>]</span> 0.0b / 3.6KiB
</span></span><span style=display:flex><span>Writing manifest to image destination
</span></span><span style=display:flex><span>Writing manifest to image destination
</span></span><span style=display:flex><span>Storing signatures
</span></span></code></pre></div><p>Now we have to apply the OpenShift resources that will install the operator
in the OCP cluster. You can use the <code>managedtenants</code> command to generate
the stage <code>SelectorSyncSet</code> and look at it for reference:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ managedtenants --environment<span style=color:#ce5c00;font-weight:700>=</span>stage --addons-dir addons --dry-run run --debug tasks/generate/99_generate_SelectorSyncSet.py
</span></span><span style=display:flex><span>Loading stage...
</span></span><span style=display:flex><span>Loading stage <span style=color:#000>OK</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>POSTTASKS</span> <span style=color:#ce5c00;font-weight:700>===================================================================</span>
</span></span><span style=display:flex><span>tasks/generate/99_generate_SelectorSyncSet.py:GenerateSSS:stage...
</span></span><span style=display:flex><span> -&gt; Generating SSS template /home/apahim/git/managed-tenants/openshift/stage.yaml
</span></span><span style=display:flex><span>tasks/generate/99_generate_SelectorSyncSet.py:GenerateSSS:stage OK
</span></span></code></pre></div><p>Here&rsquo;s the SelectorSyncSet snippet we are interested in:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>---</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>hive.openshift.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SelectorSyncSet</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterDeploymentSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>api.openshift.com/addon-managed-odh</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>resourceApplyMode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Sync</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>openshift.io/node-selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>null</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-opendatahub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>CatalogSource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh-catalog</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>openshift-marketplace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>displayName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Managed Open Data Hub Operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>quay.io/osd-addons/opendatahub-operator:stage-${IMAGE_TAG}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>publisher</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OSD Red Hat Addons</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>sourceType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>grpc</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OperatorGroup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-layered-product-og</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-opendatahub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Subscription</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-opendatahub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>channel</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>beta</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>source</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh-catalog</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>sourceNamespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>openshift-marketplace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Our OpenShift manifest to be applied to the OCP cluster looks as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>List</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>items</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-opendatahub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>CatalogSource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh-catalog</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>displayName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Managed Open Data Hub Operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>quay.io/&lt;my-repository&gt;/opendatahub-operator:stage-91918fe</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>publisher</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OSD Red Hat Addons</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>sourceType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>grpc</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OperatorGroup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-layered-product-og</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Subscription</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>channel</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>beta</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>source</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh-catalog</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>sourceNamespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>openshift-marketplace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Finally, apply it to the OCP cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ oc apply -f manifest.yaml
</span></span><span style=display:flex><span>Namespace/redhat-opendatahub created
</span></span><span style=display:flex><span>CatalogSource/addon-managed-odh-catalog created
</span></span><span style=display:flex><span>Subscription/addon-managed-odh created
</span></span><span style=display:flex><span>OperatorGroup/redhat-layered-product-og created
</span></span></code></pre></div><p>Your operator should be installed in the cluster.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d032643a49d241811ce016a5864099bb>3 - Testing With OSD-E2E</h1><h2 id=testing-with-osd-e2e>Testing With OSD-E2E</h2><p>All Add-Ons must have a reference to a test harness container in a publicly
available repository. The Add-On development team is responsible for creating and
maintaining the test harness image. That image is generated by the OSD e2e
process.</p><p>The test harness will be tested against OCP nightly and OSD next.</p><p>Please refer to the
<a href=https://github.com/openshift/osde2e-example-test-harness/blob/main/README.md>OSD-E2E Add-On Documentation</a>
for more details on how this test harness will be run and how it is expected to
report results.</p><h2 id=primer-into-osd-e2e-tests-and-prow-jobs>Primer into OSD E2E tests and prow jobs</h2><p>To ensure certain things such as validating that the addon can be easily and successfully
installed on a customer’s cluster, we have prow jobs setup which run e2e tests
(one test suite per addon) every 12 hours. If the e2e tests corresponding to any addon fail,
then automated alerts/notifications are sent to the addon team. Every addon&rsquo;s e2e tests
are packaged in an image called “testHarness”, which is built and pushed to
<a href=https://quay.io>quay.io</a>by the team maintaining the addon. Once the &ldquo;testHarness&rdquo; image is
built and pushed, the team must register their addon to testHarness image’s e2e tests by
making a PR against <a href=https://github.com/openshift/release/blob/master/ci-operator/jobs/openshift/osde2e/openshift-osde2e-main-periodics.yaml>this file</a>.</p><p>You can access the portal for prow jobs <a href=https://prow.ci.openshift.org>here</a>.
The prow jobs follow the below steps to
run the e2e tests. For every e2e test defined inside
<a href=https://github.com/openshift/release/blob/master/ci-operator/jobs/openshift/osde2e/openshift-osde2e-main-periodics.yaml>this file</a>:</p><ul><li>An OSD cluster is created and the addon, which is being tested, is installed. Openshift
API is used to perform these operations via the API definition provided at <a href=https://api.openshift.com>https://api.openshift.com</a></li><li>The e2e prow job definition, specifically for the addon from <a href=https://github.com/openshift/release/blob/master/ci-operator/jobs/openshift/osde2e/openshift-osde2e-main-periodics.yaml>this file</a>,
is parsed and hence, the parameters required to run its e2e tests will be recognized as well.</li><li>The &ldquo;testHarness&rdquo; image for the addon is parsed and executed against the parameters fetched
from the above step.</li><li>If an MT-SRE team member notices those tests failing, they should notify the respective
team to take a look at them and fix them.</li></ul></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.3bff53fa2e8d9a2c4d0b3eeea5987ff2f2cc9a0f4eccb730274827d5e7cd5538.js integrity="sha256-O/9T+i6NmixNCz7upZh/8vLMmg9OzLcwJ0gn1efNVTg=" crossorigin=anonymous></script></body></html>