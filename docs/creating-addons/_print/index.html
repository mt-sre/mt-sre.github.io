<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.111.3"><link rel=canonical type=text/html href=/docs/creating-addons/><link rel=alternate type=application/rss+xml href=/docs/creating-addons/index.xml><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon.png sizes=180x180><link rel=icon type=image/png href=/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=/favicons/android-chrome-512x512.png sizes=512x512><title>Creating Addons | Layered Products SRE</title><meta name=description content="Development resources to create and work with managed services.
"><meta property="og:title" content="Creating Addons"><meta property="og:description" content="Development resources to create and work with managed services.
"><meta property="og:type" content="website"><meta property="og:url" content="/docs/creating-addons/"><meta property="og:site_name" content="Layered Products SRE"><meta itemprop=name content="Creating Addons"><meta itemprop=description content="Development resources to create and work with managed services.
"><meta name=twitter:card content="summary"><meta name=twitter:title content="Creating Addons"><meta name=twitter:description content="Development resources to create and work with managed services.
"><link rel=preload href=/scss/main.min.0799d219d5950ac36000bb078e915525f0e42b82cd2a4e21fbeb9a6015fc5ef0.css as=style><link href=/scss/main.min.0799d219d5950ac36000bb078e915525f0e42b82cd2a4e21fbeb9a6015fc5ef0.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo></span><span class=font-weight-bold>Layered Products SRE</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/internal-documentation/access/><span>Getting Access</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.29039874ee05211a01fac727f61fbff3.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/creating-addons/>Return to the regular view of this page</a>.</p></div><h1 class=title>Creating Addons</h1><div class=lead>Development resources to create and work with managed services.</div><ul><li>1: <a href=#pg-87ba145634ea1faba32a83599fc8af8a>Monitoring Addons</a></li><ul><li>1.1: <a href=#pg-08ad524dc84aaff13a28adb213c5d2d0>SLO Dashboards</a></li><li>1.2: <a href=#pg-85e97a2a253c15db608b0997dc5e62c7>Dead Man's Snitch Operator Integration</a></li><li>1.3: <a href=#pg-a7abae99dbe9a4277957ad899b20cdcf>PagerDuty Integration</a></li><li>1.4: <a href=#pg-94ca3ec6c41e7a303011750017f383e5>OCM SendGrid Service Integration</a></li></ul><li>2: <a href=#pg-a24ef2ee1155c4863a1b3cebf1fa3eef>Testing Addons</a></li><ul><li>2.1: <a href=#pg-a741c5f669408c09f9eba6bafb09347d>Installing a specific version of an Addon in a staging environment</a></li><li>2.2: <a href=#pg-98595350eaad83b8d6f40022a940b660>Testing With OCP (Without OCM)</a></li><li>2.3: <a href=#pg-d032643a49d241811ce016a5864099bb>Testing With OSD-E2E</a></li></ul><li>3: <a href=#pg-a2fbdb75c90bc855ef557b55d6fcdc25>Top Level Operator</a></li><ul><li>3.1: <a href=#pg-25e4bd9f4a45c4e388bb613552bfe306>Customer Notifications</a></li><li>3.2: <a href=#pg-15a051846993924e91e0c5036e5a9d13>Dependencies</a></li><li>3.3: <a href=#pg-ce4044d66e5c02b22c9304d1267066c3>Environments</a></li></ul><li>4: <a href=#pg-e9538f544e6c384c53c67a269d2487ff>managed-tenants Repository</a></li><li>5: <a href=#pg-f8cb16f6aa3406735c4c9a1f009c31ae>SKU</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-87ba145634ea1faba32a83599fc8af8a>1 - Monitoring Addons</h1><div class=lead>How to monitor addons.</div></div><div class=td-content><h1 id=pg-08ad524dc84aaff13a28adb213c5d2d0>1.1 - SLO Dashboards</h1><p>Development teams are required to co-maintain, in conjunction with
the MT-SRE Team, SLO Dashboards for the Addons they develop. This
document explains how to bootstrap the dashboard creation and
deployment.</p><h2 id=first-dashboard>First Dashboard</h2><ul><li>Fork/clone the <a href=https://gitlab.cee.redhat.com/service/managed-tenants-slos>managed-tenants-slos repository</a>.</li><li>Create the following directory structure:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>├── &lt;addon-name&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>│   ├── dashboards</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>│   │   └── &lt;addon-name&gt;-slo-dashboard.configmap.yaml</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>│   └── OWNERS</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Example <code>OWNERS</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>approvers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#000>akonarde</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#000>asegundo</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p><code>&lt;addon-name>-slo-dashboard.configmap.yaml</code> contents (replace all occurrences of <code>&lt;addon-name></code>):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ConfigMap</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>&lt;addon-name&gt;-slo-dashboard</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>grafana_dashboard</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>grafana-folder</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/grafana-dashboard-definitions/Addons</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>mtsre-rhods-slos.json</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>|</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>    {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;annotations&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        &#34;list&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;builtIn&#34;: 1,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;datasource&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;type&#34;: &#34;grafana&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;uid&#34;: &#34;-- Grafana --&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;enable&#34;: true,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;hide&#34;: true,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;iconColor&#34;: &#34;rgba(0, 211, 255, 1)&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;name&#34;: &#34;Annotations &amp; Alerts&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;target&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;limit&#34;: 100,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;matchAny&#34;: false,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;tags&#34;: [],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;type&#34;: &#34;dashboard&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;type&#34;: &#34;dashboard&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        ]
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;editable&#34;: true,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;fiscalYearStartMonth&#34;: 0,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;graphTooltip&#34;: 0,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;links&#34;: [],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;liveNow&#34;: false,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;panels&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;datasource&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;type&#34;: &#34;prometheus&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;uid&#34;: &#34;4rNsqZfnz&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;fieldConfig&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;defaults&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;color&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;mode&#34;: &#34;thresholds&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;custom&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;align&#34;: &#34;auto&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;displayMode&#34;: &#34;auto&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;inspect&#34;: false
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;mappings&#34;: [],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;thresholds&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;mode&#34;: &#34;absolute&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;steps&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;color&#34;: &#34;green&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;value&#34;: null
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;color&#34;: &#34;red&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;value&#34;: 80
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                ]
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;overrides&#34;: []
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;gridPos&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;h&#34;: 16,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;w&#34;: 3,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;x&#34;: 0,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;y&#34;: 0
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;id&#34;: 2,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;options&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;footer&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;fields&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;reducer&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;sum&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              ],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;show&#34;: false
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;showHeader&#34;: true
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;pluginVersion&#34;: &#34;9.0.1&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;targets&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;datasource&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;type&#34;: &#34;prometheus&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;uid&#34;: &#34;4rNsqZfnz&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;editorMode&#34;: &#34;code&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;expr&#34;: &#34;group by (_id) (subscription_sync_total{name=\&#34;${addon_name}\&#34;})&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;format&#34;: &#34;table&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;range&#34;: true,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;refId&#34;: &#34;A&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          ],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;title&#34;: &#34;Clusters&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;transformations&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;id&#34;: &#34;groupBy&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              &#34;options&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                &#34;fields&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  &#34;_id&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;aggregations&#34;: [],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                    &#34;operation&#34;: &#34;groupby&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                  }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>                }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>              }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          ],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          &#34;type&#34;: &#34;table&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      ],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;schemaVersion&#34;: 36,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;style&#34;: &#34;dark&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;tags&#34;: [],
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;templating&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        &#34;list&#34;: [
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;hide&#34;: 2,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;name&#34;: &#34;addon_name&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;query&#34;: &#34;addon-&lt;addon-name&gt;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;skipUrlSync&#34;: false,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>            &#34;type&#34;: &#34;constant&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>          }
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        ]
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;time&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        &#34;from&#34;: &#34;now-6h&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>        &#34;to&#34;: &#34;now&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      },
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;timepicker&#34;: {},
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;timezone&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;title&#34;: &#34;&lt;addon-name&gt; - SLO Dashboard&#34;,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;version&#34;: 0,
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>      &#34;weekStart&#34;: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>    }</span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span></code></pre></div><ul><li>Create a Merge Request adding the files to the managed-tenants-slos git repository.</li><li>Ping @mt-sre-ic in the #forum-managed-tenants Slack channel for review.</li></ul><h2 id=dashboard-deployment>Dashboard Deployment</h2><p>Merging of the above merge request is a prerequisite for this step.</p><p>The dashboard deployment happens through app-interface, using saas-files.</p><ul><li>For each new Addon, we need to create a new saas-file in app-interface.</li><li>Give ownership of the saas-file to your team using an app-interface role file.</li></ul><p>Example Merge Request content to app-interface:</p><p><a href=https://gitlab.cee.redhat.com/service/app-interface/-/commit/9306800aabaca18cd034dfb3933a12d29506fa08>https://gitlab.cee.redhat.com/service/app-interface/-/commit/9306800aabaca18cd034dfb3933a12d29506fa08</a></p><ul><li>Ping <code>@mt-sre-ic</code> in the <code>#forum-managed-tenants</code> Slack channel for approval.</li><li>Merge Requests to app-interface are constantly reviewed/merged by AppSRE.
After the MT-SRE approval, wait until the Merge Request is merged.</li></ul><h2 id=accessing-the-dashboards>Accessing the Dashboards</h2><p>Once the app-interface merge request is merged, you will see your ConfigMaps
being deployed in the <code>#sd-mt-sre-info</code> Slack channel. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>app-sre-stage-01<span style=color:#ce5c00;font-weight:700>]</span> ConfigMap odf-ms-cluster-status applied
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>app-sre-prod-01<span style=color:#ce5c00;font-weight:700>]</span> ConfigMap odf-ms-cluster-status applied
</span></span></code></pre></div><p>Once the dashboards are deployed, you can see them here:</p><ul><li>STAGE: <a href=https://grafana.stage.devshift.net/dashboards/f/aGqy3WB7k/addons>https://grafana.stage.devshift.net/dashboards/f/aGqy3WB7k/addons</a></li><li>PRODUCTION: <a href=https://grafana.app-sre.devshift.net/dashboards/f/sDiLLtgVz/addons>https://grafana.app-sre.devshift.net/dashboards/f/sDiLLtgVz/addons</a></li></ul><h2 id=development-flow>Development Flow</h2><p>After all the configuration is in place:</p><p>STAGE:</p><ul><li>Dashboards on the STAGE Grafana instance should not be used by
external audiences other than the people developing the dashboards.</li><li>Changes in the <code>managed-tenants-slos</code> repository can be merged by the
development team with &ldquo;/lgtm&rdquo; comments from those in the OWNERS file.</li><li>After merged, changes are automatically delivered to the STAGE grafana instance.</li></ul><p>PRODUCTION:</p><ul><li>The dashboards on the PRODUCTION Grafana are pinpointed to a specific git
commit from the managed-tenants-slos repository in the corresponding
saas-file in app-interface.</li><li>After patching the git commit in the saas-file, owners of the saas-file can merge the promotion
with a &ldquo;/lgtm&rdquo; comment in the app-interface Merge Request.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-85e97a2a253c15db608b0997dc5e62c7>1.2 - Dead Man's Snitch Operator Integration</h1><h2 id=overview>Overview</h2><p><a href=https://deadmanssnitch.com/>Dead Man&rsquo;s Snitch (DMS)</a> is essentially a constantly firing
prometheus alert and an external receiver (called a snitch) that will alert should the
monitoring stack go down and stop sending alerts. The generation of the snitch URLs is
done dynamically via the
<a href=https://github.com/openshift/deadmanssnitch-operator>DMS operator</a>,
which runs on hive and is owned by SREP. The snitch URL shows up in a <a href=#generated-secret>secret</a>.</p><h2 id=usage>Usage</h2><p>The Add-On metadata file (<code>addon.yaml</code>) allows you to provide
a <code>deadmanssnitch</code> field (see <code>deadmansnitch</code> field in
the Add-On metadata file
<a href=https://github.com/mt-sre/managed-tenants-cli/blob/main/docs/tenants/zz_metadata_schema_generated.md>schema documentation</a>
for more information).
This field allows you to provide the required Dead Man&rsquo;s Snitch integration configuration.
A <code>DeadmansSnitchIntegration</code>resource is then created and applied to Hive alongside the Add-On
<a href=https://github.com/openshift/hive/blob/master/docs/syncset.md#selectorsyncset-object-definition>SelectorSyncSet (SSS)</a>.</p><h3 id=deadmanssnitchintegration-resource>DeadmansSnitchIntegration Resource</h3><p>The default DMS configurations which will be created if you specify the bare minimum
fields under &lsquo;deadmanssnitch&rsquo; field in addon metadata:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>deadmanssnitch.managed.openshift.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DeadmansSnitchIntegration</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-{{ADDON.metadata[&#39;id&#39;]}}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>deadmanssnitch-operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterDeploymentSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>## can be overridden by .deadmanssnitch.clusterDeploymentSelector field in addon metadata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>matchExpressions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{{<span style=color:#000>ADDON.metadata[&#39;label&#39;]}}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>In</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>values</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>dmsAPIKeySecretRef</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>## fixed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>deadmanssnitch-api-key</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>deadmanssnitch-operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>snitchNamePostFix</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{{<span style=color:#000>ADDON.metadata[&#39;id&#39;]}}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>## can be overridden by .deadmanssnitch.snitchNamePostFix field in addon metadata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>tags</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{{<span style=color:#000>ADDON.metadata[&#39;deadmanssnitch&#39;][&#39;tags&#39;]}}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>## Required</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>targetSecretRef</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#8f5902;font-style:italic>## can be overridden by .deadmanssnitch.targetSecretRef.name field in addon metadata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{{<span style=color:#000>ADDON.metadata[&#39;id&#39;]}}-deadmanssnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#8f5902;font-style:italic>## can be overridden by .deadmanssnitch.targetSecretRef.namespace field in addon metadata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{{<span style=color:#000>ADDON.metadata[&#39;targetNamespace&#39;]}}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=examples-of-deadmanssnitch-field-in-addonyaml>Examples of <code>deadmanssnitch</code> field in <code>addon.yaml</code></h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>id</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ocs-converged</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>deadmanssnitch</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>tags</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;ocs-converged-stage&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>id</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>deadmanssnitch</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>snitchNamePostFix</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rhods</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>tags</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;rhods-integration&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>targetSecretRef</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-rhods-deadmanssnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-ods-monitoring</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>id</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>managed-api-service-internal</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>...</span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>deadmanssnitch</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>clusterDeploymentSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>matchExpressions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;api.openshift.com/addon-managed-api-service-internal&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>In</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>values</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;api.openshift.com/addon-managed-api-service-internal-delete&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>operator</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NotIn</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>values</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#4e9a06>&#39;true&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>snitchNamePostFix</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rhoam</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>tags</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;rhoam-production&#34;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>targetSecretRef</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-rhoami-deadmanssnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-rhoami-operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=generated-secret>Generated Secret</h3><p>A secrete will be generated (by default in the same namespace as your addon) with the <code>SNITCH_URL</code>.
Your add-on will need to pick up the generated secret in cluster and inject it into your
alertmanager config. Example of in-cluster created secret:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Secret</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-myaddon-operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>hive.openshift.io/managed</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;true&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>data</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>SNITCH_URL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>#url like https://nosnch.in/123123123</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Opaque</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=alert>Alert</h3><p>Your alertmanager will need a constantly firing alert that is routed to DMS:
Example of an alert that always fires:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DeadManSnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>interval</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>1m</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>rules</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>alert</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DeadManSnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>expr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>vector(1)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>severity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>critical</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>This is a DeadManSnitch to ensure RHODS monitoring and alerting pipeline is online.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>summary</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Alerting DeadManSnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=route>Route</h2><p>Example of a route that forwards the firing-alert to DMS:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>match</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>alertname</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>DeadManSnitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>receiver</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>deadman-snitch</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>repeat_interval</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>5m</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h2 id=receiver>Receiver</h2><p>Example receiver for DMS:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;deadman-snitch&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>webhook_configs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>url</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;&lt;snitch_url&gt;?m=just+checking+in&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>send_resolved</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><div class="alert alert-primary" role=alert>Before going live with the SRES SRE team, they will need to manually point the <code>tags: ["my-addon-production"]</code>
in the Service Delivery DMS account to their pagerduty service.</div><p>Please log a JIRA with your assigned SRE team to have this completed at least one week
before going live with the SRE team.</p><h3 id=current-example>Current Example</h3><ul><li><a href=https://gitlab.cee.redhat.com/service/managed-tenants/-/blob/09cf5112e7dc5588c14f158d6490f7f1e7051c6a/addons/managed-api-service-internal/metadata/production/deadmanssnitch.yaml.j2>RHOAM addon: DMS CR template</a></li><li><a href=https://gitlab.cee.redhat.com/service/managed-tenants/-/blob/09cf5112e7dc5588c14f158d6490f7f1e7051c6a/addons/managed-api-service-internal/metadata/production/addon.yaml#L40>RHOAM addon: extraResources</a>
field in <code>addon.yaml</code></li><li><a href=https://github.com/red-hat-data-services/odh-deployer/blob/cb48c55725fd32fdc89a5ff29517b3f4cc0d1f54/monitoring/prometheus/prometheus.yaml>RHODS addon: alertmanager configuration</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-a7abae99dbe9a4277957ad899b20cdcf>1.3 - PagerDuty Integration</h1><p>The PagerDuty integration is configured in the <code>pagerduty</code> field in the
<a href=https://github.com/mt-sre/managed-tenants-cli/blob/main/docs/tenants/zz_metadata_schema_generated.md>addon.yaml metadata file</a>.
Given this configuration, a secret with the specified name is created in the
specified namespace by the <a href=https://github.com/openshift/pagerduty-operator>PagerDuty Operator</a>,
which runs on Hive. The secret contains the <code>PAGERDUTY_KEY</code>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-94ca3ec6c41e7a303011750017f383e5>1.4 - OCM SendGrid Service Integration</h1><p><a href=https://gitlab.cee.redhat.com/service/ocm-sendgrid-service#sending-addon-cluster-logs-to-ocm-sendgrid-service>OCM SendGrid Service</a>
is an event driven service that manages SendGrid subuser accounts and credential
bundles based on addon cluster logs.</p><p>The secret name and namespace are configured in app interface, see <a href=https://gitlab.cee.redhat.com/service/ocm-sendgrid-service#add-addon-to-supported-services-configmap>this section</a>
in the documentation.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a24ef2ee1155c4863a1b3cebf1fa3eef>2 - Testing Addons</h1><div class=lead>How to test addons.</div></div><div class=td-content><h1 id=pg-a741c5f669408c09f9eba6bafb09347d>2.1 - Installing a specific version of an Addon in a staging environment</h1><p>Add-on services are typically installed using the OpenShift Cluster Manager
web console, by selecting the specific addon from the <strong>Add-ons</strong> tab and
clicking <strong>Install</strong>.
However, only the latest version of an addon service can be installed using
the OpenShift Cluster Manager console.</p><p>In some cases, you might need to install an older version of an addon, for
example, to test the upgrade of an addon from one version to the next.
Follow this procedure to install a specific version of an addon service in a
staging environment.</p><p><strong>IMPORTANT:</strong>
Installing an addon service using this procedure is only recommended for testing
upgrades in a staging environment and is not supported for customer-facing
production workloads.</p><h2 id=prerequisites>Prerequisites</h2><ul><li><p>You have the <code>version_select</code> capability added to your organization by
creating a merge request to the <a href=https://gitlab.cee.redhat.com/service/ocm-resources><em>ocm-resources respository</em></a>.</p><p>For more information about assigning capabilities to an organization,
see <a href=https://source.redhat.com/groups/public/openshiftplatformsre/blog/customer_capabilities_management><em>Customer Capabilities Management</em></a>.
For more information about enabling the <code>version_select</code> capability,
see <a href=https://gitlab.cee.redhat.com/service/ocm-resources/-/commit/35198592011391d4c296ff75d70a93a454104467><em>organization YAML example</em></a>
and <a href=https://gitlab.cee.redhat.com/service/ocm-resources/-/merge_requests/3271><em>merge request example</em></a>.</p></li></ul><h2 id=procedure>Procedure</h2><ol><li><p>Create a JSON file with the addon service and addon version that you want
to install. In this example, the JSON file is <code>install-payload.json</code>, the
addon id is <code>reference-addon</code>, and the version we want to install is <code>0.6.7</code>.</p><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&#34;addon&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reference-addon&#34;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span> <span style=color:#204a87;font-weight:700>&#34;addon_version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>   <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;0.6.7&#34;</span>
</span></span><span style=display:flex><span> <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>NOTE:</strong> If the addon that you are installing has a required parameter, ensure
that you add it to the JSON file. For instance, the <code>managed-odh</code> addon,
which is shown in the example below, requires the parameter <code>notification-email</code>
to be included.</p><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;addon&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;managed-odh&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;addon_version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;1.23.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;parameters&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;items&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;notification-email&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>          <span style=color:#204a87;font-weight:700>&#34;value&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;me@somewhere.com&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div></li><li><p>Set the <code>CLUSTER_ID</code> environment variable:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>CLUSTER_ID</span><span style=color:#ce5c00;font-weight:700>=</span>&lt;your_cluster_internal_id&gt;
</span></span></code></pre></div></li><li><p>Run the following API request to install the addon:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm post /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addons --body install-payload.json
</span></span></code></pre></div></li><li><p>Verify the addon installation:</p><ol><li><p>Log into your cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>oc login
</span></span></code></pre></div></li><li><p>Run the <code>oc get addons</code> command to view the addon installation status:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ oc get addons
</span></span><span style=display:flex><span>NAME              STATUS   AGE
</span></span><span style=display:flex><span>reference-addon   Pending  10m
</span></span></code></pre></div></li><li><p>Optionally, run the <code>watch</code> command to watch the addon installation status:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ watch oc get addons
</span></span><span style=display:flex><span>NAME                 STATUS    AGE
</span></span><span style=display:flex><span>reference-addon      Ready     32m
</span></span></code></pre></div></li></ol></li><li><p>If you do not want the addon to automatically upgrade to the
latest version after installation, delete the addon upgrade policy before the
addon installation completes.</p><ol><li><p>List the upgrade policies:</p><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ocm get /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;kind&#34;</span>: <span style=color:#4e9a06>&#34;AddonUpgradePolicyList&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;page&#34;</span>: 1,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;size&#34;</span>: 1,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;total&#34;</span>: 1,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;items&#34;</span>: <span style=color:#ce5c00;font-weight:700>[</span>
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;kind&#34;</span>: <span style=color:#4e9a06>&#34;AddonUpgradePolicy&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;id&#34;</span>: <span style=color:#4e9a06>&#34;991a69a5-ce33-11ed-9dda-0a580a8308f5&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;href&#34;</span>: <span style=color:#4e9a06>&#34;/api/clusters_mgmt/v1/clusters/22ogsfo8kd36bk280b6bqbi7l03micmm/addon_upgrade_policies/991a69a5-ce33-11ed-9dda-0a580a8308f5&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;schedule&#34;</span>: <span style=color:#4e9a06>&#34;0,15,30,45 * * * *&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;schedule_type&#34;</span>: <span style=color:#4e9a06>&#34;automatic&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;upgrade_type&#34;</span>: <span style=color:#4e9a06>&#34;ADDON&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;version&#34;</span>: <span style=color:#4e9a06>&#34;&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;next_run&#34;</span>: <span style=color:#4e9a06>&#34;2023-03-29T19:30:00Z&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;cluster_id&#34;</span>: <span style=color:#4e9a06>&#34;22ogsfo8kd36bk280b6bqbi7l03micmm&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;addon_id&#34;</span>: <span style=color:#4e9a06>&#34;reference-addon&#34;</span>
</span></span><span style=display:flex><span> <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div></li><li><p>Delete the addon upgrade policy:</p><p><strong>Syntax</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm delete /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies/&lt;addon_upgrade_policy_id&gt;
</span></span></code></pre></div><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm delete /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies/991a69a5-ce33-11ed-9dda-0a580a8308f5
</span></span></code></pre></div></li><li><p>Verify the upgrade policy no longer exists:</p><p><strong>Syntax</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm get /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies <span style=color:#000;font-weight:700>|</span> grep &lt;addon_upgrade_policy_id&gt;
</span></span></code></pre></div><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm get /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies <span style=color:#000;font-weight:700>|</span> grep 991a69a5-ce33-11ed-9dda-0a580a8308f5
</span></span></code></pre></div></li></ol></li><li><p>Review the addon installation status and version:</p><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>$ oc get addons reference-addon -o yaml</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addons.managed.openshift.io/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Addon</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-03-20T19:07:08Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>finalizers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span>- <span style=color:#000>addons.managed.openshift.io/cache</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>displayName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Reference Addon</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>pause</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0.6.7</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>conditions</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-03-20T19:08:10Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>FullyReconciled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Available</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>lastTransitionTime</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;2023-03-20T19:08:10Z&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>message</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Addon has been successfully installed.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>reason</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AddonInstalled</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;True&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Installed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>lastObservedAvailableCSV</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-reference-addon/reference-addon.v0.6.7</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>observedGeneration</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>observedVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0.6.7</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>phase</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Ready</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>In this example, you can see the addon version is set to <code>0.6.7</code>
and <code>AddonInstalled</code> status is <code>True</code>.</p></li><li><p>(Optional) If needed, recreate the addon upgrade policy manually.</p><ol><li><p>Create a JSON file with the addon upgrade policy information.</p><p><strong>Example of automatic upgrade</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;kind&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;AddonUpgradePolicy&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;addon_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reference-addon&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;cluster_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;$CLUSTER_ID&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;schedule_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;automatic&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;upgrade_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;ADDON&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>Example of manual upgrade</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;kind&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;AddonUpgradePolicy&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;addon_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reference-addon&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;cluster_id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;$CLUSTER_ID&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;schedule_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;manual&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;upgrade_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;ADDON&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;0.7.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>In the example above, the schedule_type for the <code>reference-addon</code> is
set to <code>manual</code> and the version to upgrade to is set <code>0.7.0</code>. The upgrade
policy will execute once and the addon will upgrade to version <code>0.7.0</code>.</p></li><li><p>Run the following API request to install the addon upgrade policy:</p><p><strong>Syntax</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm post /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies --body &lt;your_json_filename&gt;
</span></span></code></pre></div><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm post /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies --body reference-upgrade-policy.json
</span></span></code></pre></div></li><li><p>Verify the upgrade policy exists:</p><p><strong>Syntax</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> ocm get /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.items[] | select(.addon_id==&#34;&lt;addon_id&gt;&#34;)&#39;</span>
</span></span></code></pre></div><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm get /api/clusters_mgmt/v1/clusters/<span style=color:#000>$CLUSTER_ID</span>/addon_upgrade_policies <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.items[] | select(.addon_id==&#34;reference-addon&#34;)&#39;</span>
</span></span></code></pre></div></li></ol></li></ol><h2 id=useful-commands>Useful commands</h2><ul><li><p>Get a list of available addons:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm get /api/clusters_mgmt/v1/addons <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.items[].id&#39;</span>
</span></span></code></pre></div></li><li><p>Get a list of available versions to install for a given addon id:</p><p><strong>Syntax</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ocm get /api/clusters_mgmt/v1/addons/&lt;addon-id&gt;/versions <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.items[].id&#39;</span>
</span></span></code></pre></div><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ocm get /api/clusters_mgmt/v1/addons/reference-addon/versions <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.items[].id&#39;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.0.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.1.5&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.1.6&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.2.2&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.3.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.3.1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.3.2&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.4.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.4.1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.5.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.5.1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.2&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.3&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.4&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.5&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.6&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.6.7&#34;</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;0.7.0&#34;</span>
</span></span></code></pre></div></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-98595350eaad83b8d6f40022a940b660>2.2 - Testing With OCP (Without OCM)</h1><h2 id=testing-without-ocm>Testing Without OCM</h2><p>During the development process, it might be useful (and cheaper) to run your
addon on an OCP cluster.</p><p>You can spin up an OCP cluster on your local machine using
<a href=https://cloud.redhat.com/openshift/install/crc/installer-provisioned>CRC</a>.</p><p>OCP and OSD differ in one important aspect: OCP gives you full access, while
OSD restricts the administrative actions. But Managed Tenants will apply
resources as unrestricted admin to OSD, just like you can do with your OCP,
so OCP is a good OSD mockup for our use case.</p><p>By doing this, you&rsquo;re skipping:</p><ul><li>OCM and SKU management</li><li>Hive</li></ul><p>First, you have to build your catalog. Let take the <code>managed-odh</code> as example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ managedtenants --environment<span style=color:#ce5c00;font-weight:700>=</span>stage --addons-dir addons --dry-run run --debug tasks/deploy/10_build_push_catalog.py:managed-odh
</span></span><span style=display:flex><span>Loading stage...
</span></span><span style=display:flex><span>Loading stage <span style=color:#000>OK</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>TASKS</span> <span style=color:#ce5c00;font-weight:700>=======================================================================</span>
</span></span><span style=display:flex><span>tasks/deploy/10_build_push_catalog.py:BuildCatalog:managed-odh:stage...
</span></span><span style=display:flex><span> -&gt; creating the temporary directory
</span></span><span style=display:flex><span> -&gt; /tmp/managed-odh-stage-1bkjtsea
</span></span><span style=display:flex><span> -&gt; generating the bundle directory
</span></span><span style=display:flex><span> -&gt; generating the bundle package.yaml
</span></span><span style=display:flex><span> -&gt; building the docker image
</span></span><span style=display:flex><span> -&gt; <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#39;docker&#39;</span>, <span style=color:#4e9a06>&#39;build&#39;</span>, <span style=color:#4e9a06>&#39;-f&#39;</span>, PosixPath<span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#39;/home/apahim/git/managed-tenants/Dockerfile.catalog&#39;</span><span style=color:#ce5c00;font-weight:700>)</span>, <span style=color:#4e9a06>&#39;-t&#39;</span>, <span style=color:#4e9a06>&#39;quay.io/osd-addons/opendatahub-operator:stage-91918fe&#39;</span>, PosixPath<span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#39;/tmp/managed-odh-stage-1bkjtsea&#39;</span><span style=color:#ce5c00;font-weight:700>)]</span>
</span></span><span style=display:flex><span>tasks/deploy/10_build_push_catalog.py:BuildCatalog:managed-odh:stage OK
</span></span><span style=display:flex><span>tasks/deploy/10_build_push_catalog.py:PushCatalog:managed-odh:stage...
</span></span><span style=display:flex><span> -&gt; pushing the docker image
</span></span><span style=display:flex><span> -&gt; <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#39;docker&#39;</span>, <span style=color:#4e9a06>&#39;--config&#39;</span>, <span style=color:#4e9a06>&#39;/home/apahim/.docker&#39;</span>, <span style=color:#4e9a06>&#39;push&#39;</span>, <span style=color:#4e9a06>&#39;quay.io/osd-addons/opendatahub-operator:stage-91918fe&#39;</span><span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>tasks/deploy/10_build_push_catalog.py:PushCatalog:managed-odh:stage OK
</span></span></code></pre></div><p>That command has built the image
<code>quay.io/osd-addons/opendatahub-operator:stage-91918fe</code> on your local machine.</p><p>You can inspect the image with:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker run --rm -it --entrypoint <span style=color:#4e9a06>&#34;bash&#34;</span>  quay.io/osd-addons/opendatahub-operator:stage-91918fe -c <span style=color:#4e9a06>&#34;ls manifests/&#34;</span>
</span></span><span style=display:flex><span>0.8.0  1.0.0-experiment  managed-odh.package.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ docker run --rm -it --entrypoint <span style=color:#4e9a06>&#34;bash&#34;</span>  quay.io/osd-addons/opendatahub-operator:stage-91918fe -c <span style=color:#4e9a06>&#34;cat manifests/managed-odh.package.yml&#34;</span>
</span></span><span style=display:flex><span>channels:
</span></span><span style=display:flex><span>- currentCSV: opendatahub-operator.1.0.0-experiment
</span></span><span style=display:flex><span>  name: beta
</span></span><span style=display:flex><span>defaultChannel: beta
</span></span><span style=display:flex><span>packageName: managed-odh
</span></span></code></pre></div><p>Next, you have to tag/push that image to some public registry repository of
yours:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker tag quay.io/osd-addons/opendatahub-operator:stage-91918fe quay.io/&lt;my-repository&gt;/opendatahub-operator:stage-91918fe
</span></span><span style=display:flex><span>$ docker push quay.io/&lt;my-repository&gt;/opendatahub-operator:stage-91918fe
</span></span><span style=display:flex><span>Getting image <span style=color:#204a87>source</span> signatures
</span></span><span style=display:flex><span>Copying blob 9fbc4a1ed0b0 <span style=color:#204a87;font-weight:700>done</span>
</span></span><span style=display:flex><span>Copying blob c4d8f7894b7d skipped: already exists
</span></span><span style=display:flex><span>Copying blob 61598d8d1b24 skipped: already exists
</span></span><span style=display:flex><span>Copying blob 38ada4bcd26f skipped: already exists
</span></span><span style=display:flex><span>Copying blob d5fdf1f627c8 skipped: already exists
</span></span><span style=display:flex><span>Copying blob 2bf094d88b12 skipped: already exists
</span></span><span style=display:flex><span>Copying blob 8a6c7bacb5db <span style=color:#204a87;font-weight:700>done</span>
</span></span><span style=display:flex><span>Copying config 3088e48540 <span style=color:#204a87;font-weight:700>done</span>
</span></span><span style=display:flex><span>Writing manifest to image destination
</span></span><span style=display:flex><span>Copying config 3088e48540 <span style=color:#ce5c00;font-weight:700>[</span>--------------------------------------<span style=color:#ce5c00;font-weight:700>]</span> 0.0b / 3.6KiB
</span></span><span style=display:flex><span>Writing manifest to image destination
</span></span><span style=display:flex><span>Writing manifest to image destination
</span></span><span style=display:flex><span>Storing signatures
</span></span></code></pre></div><p>Now we have to apply the OpenShift resources that will install the operator
in the OCP cluster. You can use the <code>managedtenants</code> command to generate
the stage <code>SelectorSyncSet</code> and look at it for reference:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ managedtenants --environment<span style=color:#ce5c00;font-weight:700>=</span>stage --addons-dir addons --dry-run run --debug tasks/generate/99_generate_SelectorSyncSet.py
</span></span><span style=display:flex><span>Loading stage...
</span></span><span style=display:flex><span>Loading stage <span style=color:#000>OK</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>POSTTASKS</span> <span style=color:#ce5c00;font-weight:700>===================================================================</span>
</span></span><span style=display:flex><span>tasks/generate/99_generate_SelectorSyncSet.py:GenerateSSS:stage...
</span></span><span style=display:flex><span> -&gt; Generating SSS template /home/apahim/git/managed-tenants/openshift/stage.yaml
</span></span><span style=display:flex><span>tasks/generate/99_generate_SelectorSyncSet.py:GenerateSSS:stage OK
</span></span></code></pre></div><p>Here&rsquo;s the SelectorSyncSet snippet we are interested in:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>---</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>hive.openshift.io/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SelectorSyncSet</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>clusterDeploymentSelector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>api.openshift.com/addon-managed-odh</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>resourceApplyMode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Sync</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>openshift.io/node-selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>null</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-opendatahub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>CatalogSource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh-catalog</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>openshift-marketplace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>displayName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Managed Open Data Hub Operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>quay.io/osd-addons/opendatahub-operator:stage-${IMAGE_TAG}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>publisher</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OSD Red Hat Addons</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>sourceType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>grpc</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OperatorGroup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-layered-product-og</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-opendatahub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Subscription</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-opendatahub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>channel</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>beta</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>source</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh-catalog</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>sourceNamespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>openshift-marketplace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Our OpenShift manifest to be applied to the OCP cluster looks as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>List</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>items</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Namespace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-opendatahub</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>CatalogSource</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh-catalog</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>displayName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Managed Open Data Hub Operator</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>quay.io/&lt;my-repository&gt;/opendatahub-operator:stage-91918fe</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>publisher</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OSD Red Hat Addons</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>sourceType</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>grpc</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OperatorGroup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>redhat-layered-product-og</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>operators.coreos.com/v1alpha1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Subscription</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>channel</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>beta</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>managed-odh</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>source</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>addon-managed-odh-catalog</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>sourceNamespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>openshift-marketplace</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Finally, apply it to the OCP cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ oc apply -f manifest.yaml
</span></span><span style=display:flex><span>Namespace/redhat-opendatahub created
</span></span><span style=display:flex><span>CatalogSource/addon-managed-odh-catalog created
</span></span><span style=display:flex><span>Subscription/addon-managed-odh created
</span></span><span style=display:flex><span>OperatorGroup/redhat-layered-product-og created
</span></span></code></pre></div><p>Your operator should be installed in the cluster.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d032643a49d241811ce016a5864099bb>2.3 - Testing With OSD-E2E</h1><h2 id=testing-with-osd-e2e>Testing With OSD-E2E</h2><p>All Add-Ons must have a reference to a test harness container in a publicly
available repository. The Add-On development team is responsible for creating and
maintaining the test harness image. That image is generated by the OSD e2e
process.</p><p>The test harness will be tested against OCP nightly and OSD next.</p><p>Please refer to the
<a href=https://github.com/openshift/osde2e-example-test-harness/blob/main/README.md>OSD-E2E Add-On Documentation</a>
for more details on how this test harness will be run and how it is expected to
report results.</p><h2 id=primer-into-osd-e2e-tests-and-prow-jobs>Primer into OSD E2E tests and prow jobs</h2><p>To ensure certain things such as validating that the addon can be easily and successfully
installed on a customer’s cluster, we have prow jobs setup which run e2e tests
(one test suite per addon) every 12 hours. If the e2e tests corresponding to any addon fail,
then automated alerts/notifications are sent to the addon team. Every addon&rsquo;s e2e tests
are packaged in an image called “testHarness”, which is built and pushed to
<a href=https://quay.io>quay.io</a>by the team maintaining the addon. Once the &ldquo;testHarness&rdquo; image is
built and pushed, the team must register their addon to testHarness image’s e2e tests by
making a PR against <a href=https://github.com/openshift/release/blob/master/ci-operator/jobs/openshift/osde2e/openshift-osde2e-main-periodics.yaml>this file</a>.</p><p>You can access the portal for prow jobs <a href=https://prow.ci.openshift.org>here</a>.
The prow jobs follow the below steps to
run the e2e tests. For every e2e test defined inside
<a href=https://github.com/openshift/release/blob/master/ci-operator/jobs/openshift/osde2e/openshift-osde2e-main-periodics.yaml>this file</a>:</p><ul><li>An OSD cluster is created and the addon, which is being tested, is installed. Openshift
API is used to perform these operations via the API definition provided at <a href=https://api.openshift.com>https://api.openshift.com</a></li><li>The e2e prow job definition, specifically for the addon from <a href=https://github.com/openshift/release/blob/master/ci-operator/jobs/openshift/osde2e/openshift-osde2e-main-periodics.yaml>this file</a>,
is parsed and hence, the parameters required to run its e2e tests will be recognized as well.</li><li>The &ldquo;testHarness&rdquo; image for the addon is parsed and executed against the parameters fetched
from the above step.</li><li>If an MT-SRE team member notices those tests failing, they should notify the respective
team to take a look at them and fix them.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-a2fbdb75c90bc855ef557b55d6fcdc25>3 - Top Level Operator</h1><div class=lead>Top Level Operator.</div></div><div class=td-content><h1 id=pg-25e4bd9f4a45c4e388bb613552bfe306>3.1 - Customer Notifications</h1><h2 id=status-page>Status Page</h2><p><a href=https://gitlab.cee.redhat.com/service/app-interface/-/blob/master/docs/app-sre/statuspage.md>https://gitlab.cee.redhat.com/service/app-interface/-/blob/master/docs/app-sre/statuspage.md</a></p><p><a href=https://service.pages.redhat.com/dev-guidelines/docs/appsre/advanced/statuspage/>https://service.pages.redhat.com/dev-guidelines/docs/appsre/advanced/statuspage/</a></p><h2 id=service-logs>Service Logs</h2><p><a href=https://gitlab.cee.redhat.com/service/managed-tenants-sops/-/blob/main/MT-SRE/sops/mt-sre-customer-notification.md>https://gitlab.cee.redhat.com/service/managed-tenants-sops/-/blob/main/MT-SRE/sops/mt-sre-customer-notification.md</a></p><h2 id=internal-email>Internal Email</h2><p>There are multiple ways a user or group can get notified of service events (e.g.
planned maintenance, outages). There are two fields in the addon metadata file
(see Add-On metadata file <a href=https://github.com/mt-sre/managed-tenants-cli/blob/main/docs/tenants/zz_metadata_schema_generated.md>schema documentation</a>
for more information) where email addresses can be provided:</p><ul><li><code>addonOwner</code>: <em>REQUIRED</em> Point of contact for communications from Service Delivery to
addon owners. Where possible, this should be a development team mailing list
(rather than an individual developer).</li><li><code>addonNotifications</code>: This is a list of additional email addresses of
employees who would like to receive notifications about a service.</li></ul><p>There is also a mailing list that receives notifications for all services managed
by Service Delivery. Subscribe to the sd-notifications mailing list
<a href=https://post-office.corp.redhat.com/mailman/listinfo/sd-notifications>here</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-15a051846993924e91e0c5036e5a9d13>3.2 - Dependencies</h1><p>This document describes the supported implementation for Addon dependencies,
as signed-off by the Managed Tenants SRE Team.</p><h2 id=dependencies-specification>Dependencies Specification</h2><ul><li>Addons must specify dependencies using the OLM dependencies feature,
documented <a href=https://docs.openshift.com/container-platform/4.7/operators/understanding/olm/olm-understanding-dependency-resolution.html>here</a></li><li>The dependencies must have the version pin-pointed. Ranges are not allowed.</li><li>The dependencies must come from a <em>Trusted Catalog</em>. See the
<a href=#trusted-catalogs>Trusted Catalogs</a> section for details.</li></ul><h2 id=trusted-catalogs>Trusted Catalogs</h2><p>The Addon and its dependencies must come from Trusted Catalogs. Trusted
Catalogs are those with content published by the Managed Services Pipelines,
implemented by CPaaS, or by the Managed Tenants SRE Team.</p><h3 id=trusted-catalogs-list>Trusted Catalogs List</h3><ul><li>Addon catalog: the catalog created by the Managed Tenants SRE Team, for the
purpose of releasing the Addon. Dependency bundles can be shipped in the same
catalog of the Addon. The Addon catalog is considered &ldquo;trusted&rdquo; for
the dependencies it carries.</li><li>Red Hat Operators catalog: the catalog content goes through the Managed
Services Pipelines, same process to build some Addons themselves, just with
a different release process. This catalog is considered &ldquo;trusted&rdquo; and can be
used for dependencies.</li></ul><h3 id=including-a-catalog-in-the-trusted-list>Including a Catalog in the Trusted List</h3><ul><li>Make sure that the catalog is available on OSD and its content is released
through the Managed Services Pipelines, implemented by CPaaS.</li><li>Create a Jira ticket in the
<a href="https://issues.redhat.com/secure/CreateIssue.jspa?pid=12326231&amp;issuetype=3">MT-SRE Team backlog</a>,
requesting the assessment of the OSD catalog you want to consider as
&ldquo;trusted&rdquo;.</li></ul><h2 id=issues>Issues</h2><p>There&rsquo;s a feature request to the OLM Team to allow specifying the
CatalogSource used for the dependencies:</p><ul><li><a href=https://issues.redhat.com/browse/OLM-2249>OLM-2249</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-ce4044d66e5c02b22c9304d1267066c3>3.3 - Environments</h1><h2 id=mandatory-environments>Mandatory environments</h2><p>Add-ons are normally deployed to two environments:</p><ul><li><code>ocm stage</code>: development/testing - All add-ons <strong>must</strong> deploy to this
environment before being released to production.</li><li><code>ocm production</code>: once the deployment in stage has been reviewed,
accepted, and approved it can be promoted to production via <code>/lgtm</code> by
your SRE team.</li></ul><p>We recommend the <code>ocm stage</code> and <code>ocm production</code> add-on metadata be as
similar as possible.</p><h2 id=slos>SLOs</h2><p><code>ocm stage</code> have no SLO and operates with best effort support from Add-on SRE,
SREP, and App-SRE
<code>osd stage cluster</code> have no SLO and operates with best effort support from Add-on
SRE, SREP, and App-SRE
<code>ocm production</code> environments are subject to App-SRE <a href=https://gitlab.cee.redhat.com/app-sre/contract/-/blob/master/README.md#appsre-service-level-objectives>SLOs</a>.
<code>osd production cluster</code> environments are subject OSD <a href=https://source.redhat.com/groups/public/openshiftplatformsre/wiki/faq_openshift_dedicated_service_level_objectives>SLOs</a>.</p><h2 id=additional-environments-via-duplicate-add-ons>Additional Environments (via duplicate add-ons)</h2><p>Some add-on providers have had use cases which require additional add-on envs.
While we only have <code>ocm stage</code> and <code>ocm prod</code>, managed-tenants may be leveraged
to deploy to an additional add-on (like edge or internal). Today we don&rsquo;t recommend
this practice due to the need to clone all add-on metadata which increases the
risk for incorrect metadata going to production/customer clusters.</p><p>If you need to do the above, please reach out to your assigned SRE team for
guidance first.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-e9538f544e6c384c53c67a269d2487ff>4 - managed-tenants Repository</h1><div class=lead>managed-tenants Repository.</div><p>Addons are deployed through GitOps pipelines. Most of the configuration for Addons can
be found in the
<a href=https://gitlab.cee.redhat.com/service/managed-tenants>managed-tenants Repository</a>
. See the
<a href=https://gitlab.cee.redhat.com/service/managed-tenants/-/blob/main/docs/tenants/create_an_addon.md>create an addon</a>
documentation page for a good starting point.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-f8cb16f6aa3406735c4c9a1f009c31ae>5 - SKU</h1><div class=lead>How to request a SKU for your addon.</div><p><strong>NOTE</strong> MT-SRE do not influence SKU creation/priorities.
You must work with SDB directly for this.</p><h2 id=requesting-a-sku>Requesting a SKU</h2><p>To request a SKU, please complete the following steps:</p><ul><li>Determine a unique quota ID for the addon. This should be
lowercase with dashes and of the format <code>addon-&lt;addon-name></code>. For example:
<code>addon-prow-operator</code></li><li>Create a JIRA Request at <a href=https://issues.redhat.com/projects/SDB/>Service Dev Team B</a>
with the subject <code>Request for new Add-On SKU in OCM</code> and the following information:<ul><li>Add-On name.</li><li>Add-On owner.</li><li>Requested Add-On unique quota ID.</li><li>Additional information that would help qualify the ask, including goals,
timelines, etc., you might have in mind.</li></ul></li><li>You will need at least your PM and the OCM PM&rsquo;s to sign off before the SKU
is created. We expect to resolve these requests within 7 working days.</li></ul><h2 id=requesting-sku-attributes-changes>Requesting SKU Attributes Changes</h2><p>From time to time you may want to update some SKU fields like supported cloud providers,
quota cost, product support, etc. To do this:</p><ul><li>Create a JIRA Request at <a href=https://issues.redhat.com/projects/SDB/>Service Dev Team B</a></li><li>Ping the ticket in #service-development-b Slack channel (@sd-b-team is the handle)</li><li>This requires an update to be committed in-code in AMS, then deployed to stage and
eventually prod (allow up to 7 working days).</li></ul><h2 id=current-status>Current Status</h2><p>To check current SKUs and attributes, see
<a href="https://docs.google.com/spreadsheets/d/1HGvQnahZCxb_zYH2kSnnTFsxy9MM49vywd-P0X_ISLA/edit#gid=1479779350">OCM Resource Cost Mappings</a>.</p></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.3bff53fa2e8d9a2c4d0b3eeea5987ff2f2cc9a0f4eccb730274827d5e7cd5538.js integrity="sha256-O/9T+i6NmixNCz7upZh/8vLMmg9OzLcwJ0gn1efNVTg=" crossorigin=anonymous></script></body></html>